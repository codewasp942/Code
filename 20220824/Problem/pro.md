# 补作业(homework.cpp/in/out)

## 题面描述

暑假快结束了，SHW 开始补作业。

他还有 $n$ 天开学，需要**按顺序**补 $m$ 本作业，第 $i$ 本作业需要 $t_i$ 的时间。SHW 有强迫症，一次至少要写一**整**本作业； SHW 不希望自己一天补太多的作业，所以他想问你，自己补作业**最多的**一天做作业的时间**最少**是多少。

看在 SHW 的父亲 CMS 的 npy —— 英俊潇洒风流倜傥的 CYB 的面子上，请你帮 SHW 解决这个问题。

## 输入格式

输入共两行。

第一行两个整数 $n,m$ ，含义如上所述。

第二行 $m$ 个整数，第 $i$ 个整数表示 $t_i$ 。含义如上所述。

## 输出格式

输出一行一个整数，表示 SHW 补作业**最多的**一天做作业的时间**最小**值。

## 样例输入

```
3 5
2 4 3 5 6
```

## 样例输出

```
8
```

## 数据范围

对于 $30 \%$ 的数据， $n, m \le 1000, t_i \le 1000$ 。

对于 $100 \%$ 的数据， $1 \le n, m \le 5 \cdot 10^{5}, 1 \le t_i \le 10^{12}$ 。

# 又要补作业(workagain.cpp/in/out)

## 题面描述

SHW 看了你上一题的答案，觉得补作业太痛苦了，于是他找来了风水大师 YCY ，希望他帮自己算一卦，以此制定做作业的计划以减轻自己的痛苦。

具体来说， YCY 告诉 SHW ，他在第 $i$ 天因为玄学原因，写作业效率为 $v_i$ （ $ 0 < v_i < 2 $ ），即写一份时间为 $t$ 的作业，实际耗时为 $t \cdot v_i$ 。而且每天写作业的**数量**（不是时间）是有上限的，为 $w_i$ （保证 $\sum_{i=1}^{n}{w_i} >= m$ ）。这样，通过合理安排作业计划， SHW 就可以减轻自己的痛苦。

但是 SHW 忙于补作业，没有时间做计划了，所以他希望你帮他做计划。看在 SHW 的母亲 CYB 的 npy —— 英俊潇洒风流倜傥的 CMS 的面子上，请你告诉 SHW 他做作业的总时间是多少。

不过空间都被 SHW 用来暴力求解数学作业了，所以**本题的空间只有64KB**。

另外，行大事者不拘小节，**答案精确到小数点后两位**即可。

## 输入格式

输入共四行。

第一行两个整数 $n,m$ ，含义如第一题所述。

第二行 $m$ 个整数，第 $i$ 个整数表示 $t_i$ 。含义如第一题所述。

第三行 $n$ 个浮点数（最多精确到小数点后两位），第 $i$ 个浮点数表示 $v_i$ 。含义如上所述。

第四行 $n$ 个整数，第 $i$ 个整数表示 $w_i$ 。含义如上所述。

## 输出格式

输出一行一个整数，表示 SHW 他做作业的总时间。

## 样例输入

```
3 5
2 4 3 5 6
1.5 1 0.5
3 2 2
```

## 样例输出

```
15.50
```

## 数据范围

对于 $10 \%$ 的数据，$v$ 具有单调性。

对于另外 $20 \%$ 的数据，$n, m \le 20$ 。

对于 $50 \%$ 的数据，$v_i \in \{0.5, 1, 1.5\}$ 。

对于 $100 \%$ 的数据， $1 \le n, m \le  1000, 1 \le w_i \le 10, 1 \le t_i \le 10^{6}$ 。

所有输入的整数数据在 `int` 范围内。

# 谈情说爱(love.cpp/in/out)

## 题面描述

在你的帮助下，SHW 解决了作业危机。但现在，他遇到了更加头疼的问题。

CMS 和 ta 的 npy —— ~~英俊……~~ CYB 是异地恋（一个在1班一个在3班），而他们又想采用传纸条这一浪漫的方法谈情说爱。作为他们的名义上的儿子， SHW 义无反顾地承担了传递小纸条的任务。

具体来说，学校可以看做一棵有 $n$ 个点 $m$ 条边的**有向无环图**。 CMS 在 $1$ 号节点，CYB 在 $n$ 号点。SHW 需要把纸条从 CMS 手中送到 CYB 手中。

在每条**边**， SHW 可能会遇到2种人：兄弟，敌人。

如果遇到了兄弟，兄弟会跟随 SHW 一起传纸条。注意 SHW 身边可以有很多兄弟。

如果遇到了敌人，会有**一名**兄弟义无反顾地牺牲自己，保护纸条安全，但如果此时身边一名兄弟也没有了，那么纸条就会有 $\frac{a}{b}$ 部分被撕掉抢走（ $a < b$ ）。

敌人也有两种，一种敌人会抢走现有纸条的 $\frac{a}{b}$ 的部分，即纸条乘上 $\frac{a}{b}$ 。另一种敌人会抢走原有纸条的 $\frac{a}{b}$ 的部分，即纸条减去 $\frac{a}{b}$ 。如果此时纸条已经不足 $\frac{a}{b}$ ，那么纸条就全部被抢走了。

**在 SHW 走过一条边之后，敌人很有精神，仍然屹立在路上。**

现在 SHW 想知道，他最多能将纸条的多少部分送给 CYB 。

另外，细节决定成败，请你**以最简分数的形式**输出答案（形如 `a/b` 且 $\gcd(a,b)=1$ ）。如果答案为0，输出 `0/1` 。如果答案为1，输出 `1/1` 。 

## 输入格式

输入 $m + 1$ 行。

第一行两个整数 $n,m$ ，含义如上所述。

接下来 $m$ 行，每行可能有3个或5个整数。前两个整数 $u, v$ 表示一条从 $u$ 到 $v$ 的边。第三个数 $op$ 取值为 $op \in \{0, 1, 2\}$ ，其中0表示这条边上是兄弟；1表示这条边上是第一种敌人，并且接下来两个整数 $a, b$ 表示敌人会抢走现有纸条的 $\frac{a}{b}$ 部分（即乘上 $\frac{a}{b}$ ）；2表示这条边上是第二种敌人，并且接下来两个整数 $a, b$ 表示敌人会抢走原有纸条的 $\frac{a}{b}$ 部分（即减去 $\frac{a}{b}$ ）。

## 输出格式

输出一行一个分数，形如 `a/b` 。如果答案为0，输出 `0/1` 。如果答案为1，输出 `1/1` 。  

## 样例输入

```
3 3
1 2 0
2 3 1 1 2
1 3 1 2 3
```

## 样例输出

```
1/1
```

## 数据范围

对于 $10 \%$ 的数据， $b=1$ 。

对于另外 $10 \%$ 的数据，没有兄弟。

对于另外 $20 \%$ 的数据， $n \le 10^3,m \le 2 \cdot 10^3$ 。

对于 $100 \%$ 的数据， $n \le 10^6,m \le 2 \cdot 10^6$ 。

所有输入数据在 `int` 范围内。

## 提示

**本题中有一句加粗的话是废话。**

~~（你猜是不是这句话）~~

# 挑选礼物(gift.cpp/in/out)

## 题目描述

小纸条内容大公开！

```
我最********的 CYB ：

我非常********，我想********，我们********，如果你愿意，我们在********来一场约会，时间********。

祝你********
你********的 CMS
```

现在 CMS 正在为约会的礼物而发愁。好在贴心的戴孝子 SHW 为 CMS 准备了许多大小为珍珠。 CMS 可以把两个珍珠串成项链，或者把两个项链串成一个大项链。但是， CYB 有一定的强迫症， ta 有一个幸运数字 k ，会在所有项链中选择第 k 大的收下。

CMS 当然希望 CYB 多拿一点，但他又说不好 CYB 的幸运数字，所以他会查看很多不同的 k 。

不过，被 ai 情占据头脑的 CMS 已经不会数数了，他让 SHW 帮他数。但是 SHW 发现自己作业写错了，忙着补作业，所以他把任务交给了你。

## 输入格式

输入共 $m + 1$ 行。

第一行两个整数 $n$ 和 $m$ ，表示有 $n$ 颗珍珠以及 CMS 有 $m$ 次操作。

接下来 m 行，每行两个或三个整数，表示一次操作。

第一个整数 $op$ 表示操作类型。如果 $op=1$ ，接下来两个数 $x, y$ ，表示将第 $x$ 颗珍珠和第 $y$ 颗珍珠所在的项链串在一起。（一个珍珠也算项链）；如果 $op=2$ ，接下来一个整数 $k$ ，表示询问第 $k$ 大项链的大小（保证 $k$ 小于等于当前项链数量）。

## 输出格式

对于每个 $op=2$ 的操作输出答案。

## 输入样例

```
10 10
1 1 2
2 4
1 3 4
2 2
1 5 6
2 1
1 7 8
2 1
1 9 10
2 1
```

## 输出样例

```
1
2
2
2
```

## 数据范围

对于 $10\%$ 的数据，保证 $1 \le n,m \le 10^3$。

对于 $30\%$ 的数据，保证 $1 \le n,m \le 10^4$。

对于 $70\%$ 的数据，保证 $1 \le n,m \le 10^5$。

对于 $100\%$ 的数据，保证 $1 \le n,m \le 2\times 10^5$。